function grid_proyectos_codigo_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_codigo" + seqRow).html();
}

function grid_proyectos_codigo_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_codigo" + seqRow).html(newValue);
}

function grid_proyectos_nombre_proyecto_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_nombre_proyecto" + seqRow).html();
}

function grid_proyectos_nombre_proyecto_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_nombre_proyecto" + seqRow).html(newValue);
}

function grid_proyectos_id_empresa_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_empresa" + seqRow).html();
}

function grid_proyectos_id_empresa_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_empresa" + seqRow).html(newValue);
}

function grid_proyectos_id_cliente_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_cliente" + seqRow).html();
}

function grid_proyectos_id_cliente_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_cliente" + seqRow).html(newValue);
}

function grid_proyectos_id_jefe_proyecto_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_jefe_proyecto" + seqRow).html();
}

function grid_proyectos_id_jefe_proyecto_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_jefe_proyecto" + seqRow).html(newValue);
}

function grid_proyectos_id_direccion_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_direccion" + seqRow).html();
}

function grid_proyectos_id_direccion_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_direccion" + seqRow).html(newValue);
}

function grid_proyectos_id_portafolio_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_portafolio" + seqRow).html();
}

function grid_proyectos_id_portafolio_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_portafolio" + seqRow).html(newValue);
}

function grid_proyectos_fecha_inicio_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_fecha_inicio" + seqRow).html();
}

function grid_proyectos_fecha_inicio_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_fecha_inicio" + seqRow).html(newValue);
}

function grid_proyectos_fecha_termino_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_fecha_termino" + seqRow).html();
}

function grid_proyectos_fecha_termino_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_fecha_termino" + seqRow).html(newValue);
}

function grid_proyectos_tipo_moneda_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_tipo_moneda" + seqRow).html();
}

function grid_proyectos_tipo_moneda_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_tipo_moneda" + seqRow).html(newValue);
}

function grid_proyectos_duracion_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_duracion" + seqRow).html();
}

function grid_proyectos_duracion_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_duracion" + seqRow).html(newValue);
}

function grid_proyectos_presupuesto_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_presupuesto" + seqRow).html();
}

function grid_proyectos_presupuesto_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_presupuesto" + seqRow).html(newValue);
}

function grid_proyectos_id_fase_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_fase" + seqRow).html();
}

function grid_proyectos_id_fase_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_fase" + seqRow).html(newValue);
}

function grid_proyectos_id_estado_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_id_estado" + seqRow).html();
}

function grid_proyectos_id_estado_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_id_estado" + seqRow).html(newValue);
}

function grid_proyectos_habilitado_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_habilitado" + seqRow).html();
}

function grid_proyectos_habilitado_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_habilitado" + seqRow).html(newValue);
}

function grid_proyectos_afecta_iva_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_afecta_iva" + seqRow).html();
}

function grid_proyectos_afecta_iva_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_afecta_iva" + seqRow).html(newValue);
}

function grid_proyectos_observaciones_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_observaciones" + seqRow).html();
}

function grid_proyectos_observaciones_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_observaciones" + seqRow).html(newValue);
}

function grid_proyectos_usuarios_getValue(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  return $("#id_sc_field_usuarios" + seqRow).html();
}

function grid_proyectos_usuarios_setValue(newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_usuarios" + seqRow).html(newValue);
}

function grid_proyectos_getValue(field, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  var SC_tmp = "";
  if ("codigo" == field) {
    SC_tmp = grid_proyectos_codigo_getValue(seqRow);
  }
  if ("nombre_proyecto" == field) {
    SC_tmp = grid_proyectos_nombre_proyecto_getValue(seqRow);
  }
  if ("id_empresa" == field) {
    SC_tmp = grid_proyectos_id_empresa_getValue(seqRow);
  }
  if ("id_cliente" == field) {
    SC_tmp = grid_proyectos_id_cliente_getValue(seqRow);
  }
  if ("id_jefe_proyecto" == field) {
    SC_tmp = grid_proyectos_id_jefe_proyecto_getValue(seqRow);
  }
  if ("id_direccion" == field) {
    SC_tmp = grid_proyectos_id_direccion_getValue(seqRow);
  }
  if ("id_portafolio" == field) {
    SC_tmp = grid_proyectos_id_portafolio_getValue(seqRow);
  }
  if ("fecha_inicio" == field) {
    SC_tmp = grid_proyectos_fecha_inicio_getValue(seqRow);
  }
  if ("fecha_termino" == field) {
    SC_tmp = grid_proyectos_fecha_termino_getValue(seqRow);
  }
  if ("tipo_moneda" == field) {
    SC_tmp = grid_proyectos_tipo_moneda_getValue(seqRow);
  }
  if ("duracion" == field) {
    SC_tmp = grid_proyectos_duracion_getValue(seqRow);
  }
  if ("presupuesto" == field) {
    SC_tmp = grid_proyectos_presupuesto_getValue(seqRow);
  }
  if ("id_fase" == field) {
    SC_tmp = grid_proyectos_id_fase_getValue(seqRow);
  }
  if ("id_estado" == field) {
    SC_tmp = grid_proyectos_id_estado_getValue(seqRow);
  }
  if ("habilitado" == field) {
    SC_tmp = grid_proyectos_habilitado_getValue(seqRow);
  }
  if ("afecta_iva" == field) {
    SC_tmp = grid_proyectos_afecta_iva_getValue(seqRow);
  }
  if ("observaciones" == field) {
    SC_tmp = grid_proyectos_observaciones_getValue(seqRow);
  }
  if ("usuarios" == field) {
    SC_tmp = grid_proyectos_usuarios_getValue(seqRow);
  }
  if (typeof(SC_tmp) == 'undefined') {
      SC_tmp = "";
  }
  else {
      SC_tmp = SC_tmp.replace(/[+]/g, "__NM_PLUS__");
      while (SC_tmp.lastIndexOf("&amp;") != -1)
      {
         SC_tmp = SC_tmp.replace("&amp;" , "__NM_AMP__");
      }
      SC_tmp = SC_tmp.replace(/[&]/g, "__NM_AMP__");
      SC_tmp = SC_tmp.replace(/[%]/g, "__NM_PRC__");
  }
  return SC_tmp;
}

function grid_proyectos_setValue(field, newValue, seqRow) {
  seqRow = scSeqNormalize(seqRow);
  if ("codigo" == field) {
    grid_proyectos_codigo_setValue(newValue, seqRow);
  }
  if ("nombre_proyecto" == field) {
    grid_proyectos_nombre_proyecto_setValue(newValue, seqRow);
  }
  if ("id_empresa" == field) {
    grid_proyectos_id_empresa_setValue(newValue, seqRow);
  }
  if ("id_cliente" == field) {
    grid_proyectos_id_cliente_setValue(newValue, seqRow);
  }
  if ("id_jefe_proyecto" == field) {
    grid_proyectos_id_jefe_proyecto_setValue(newValue, seqRow);
  }
  if ("id_direccion" == field) {
    grid_proyectos_id_direccion_setValue(newValue, seqRow);
  }
  if ("id_portafolio" == field) {
    grid_proyectos_id_portafolio_setValue(newValue, seqRow);
  }
  if ("fecha_inicio" == field) {
    grid_proyectos_fecha_inicio_setValue(newValue, seqRow);
  }
  if ("fecha_termino" == field) {
    grid_proyectos_fecha_termino_setValue(newValue, seqRow);
  }
  if ("tipo_moneda" == field) {
    grid_proyectos_tipo_moneda_setValue(newValue, seqRow);
  }
  if ("duracion" == field) {
    grid_proyectos_duracion_setValue(newValue, seqRow);
  }
  if ("presupuesto" == field) {
    grid_proyectos_presupuesto_setValue(newValue, seqRow);
  }
  if ("id_fase" == field) {
    grid_proyectos_id_fase_setValue(newValue, seqRow);
  }
  if ("id_estado" == field) {
    grid_proyectos_id_estado_setValue(newValue, seqRow);
  }
  if ("habilitado" == field) {
    grid_proyectos_habilitado_setValue(newValue, seqRow);
  }
  if ("afecta_iva" == field) {
    grid_proyectos_afecta_iva_setValue(newValue, seqRow);
  }
  if ("observaciones" == field) {
    grid_proyectos_observaciones_setValue(newValue, seqRow);
  }
  if ("usuarios" == field) {
    grid_proyectos_usuarios_setValue(newValue, seqRow);
  }
}

function scJQAddEvents(seqRow) {
  seqRow = scSeqNormalize(seqRow);
  $("#id_sc_field_nombre_proyecto" + seqRow).click(function () {
    let actionBarButtonRow = "", actionBarButtonState = "", actionBarButtonConfirm = "";
    if ("" != actionBarButtonConfirm) {
      scJs_confirm(actionBarButtonConfirm, function() { scAjaxCall_nombre_proyecto_onClick(seqRow, actionBarButtonRow, actionBarButtonState, actionBarButtonConfirm); }, function() {});
      return;
    }
    scAjaxCall_nombre_proyecto_onClick(seqRow, actionBarButtonRow, actionBarButtonState, actionBarButtonConfirm);
  }).mouseover(function() { $(this).css("cursor", "pointer"); })
    .mouseout(function() { $(this).css("cursor", "pointer"); })
    .addClass(($("#id_sc_field_nombre_proyecto" + seqRow).parent().hasClass("scGridFieldOddFont") ? "scGridFieldOddLink" : "scGridFieldEvenLink"));
}
function scAjaxCall_nombre_proyecto_onClick(seqRow, actionBarButtonRow, actionBarButtonState, actionBarButtonConfirm) {
  nmAjaxProcOn();
  $.ajax({
    type: "POST",
    url: "index.php",
    data: "nmgp_opcao=ajax_event&nmgp_event=nombre_proyecto_onClick&script_case_init=" + document.F3.script_case_init.value + "&nombre_proyecto=" + grid_proyectos_getValue("nombre_proyecto", seqRow) + ""
   })
   .done(function(jsonReturn) {
      var i, fieldDisplay, oResp;
      Tst_integrid = jsonReturn.trim();
      if ("{" != Tst_integrid.substr(0, 1)) {
        nmAjaxProcOff();
        alert (jsonReturn);
        return;
      }
      nmAjaxProcOff();
      eval("oResp = " + jsonReturn);
      if (oResp["setValue"]) {
        for (i = 0; i < oResp["setValue"].length; i++) {
          grid_proyectos_setValue(oResp["setValue"][i]["field"], oResp["setValue"][i]["value"], seqRow);
        }
      }
      if (oResp["fieldDisplay"]) {
        for (i = 0; i < oResp["fieldDisplay"].length; i++) {
          if ("off" == oResp["fieldDisplay"][i]["status"]) {
            $("#id_sc_field_" + oResp["fieldDisplay"][i]["field"] + seqRow).hide();
          }
          else {
            $("#id_sc_field_" + oResp["fieldDisplay"][i]["field"] + seqRow).show();
          }
        }
      }
      if (oResp["Refresh"]) {
         nm_gp_move('igual');
      }
      if (oResp["redirInfo"]) {
         nmAjaxRedir(oResp);
      }
      if (oResp["changeCss"]) {
         nmAjaxChangeCss(oResp["changeCss"], seqRow);
      }
      if (oResp["htmOutput"]) {
        nmAjaxShowDebug(oResp);
      }
  });
}

function scSeqNormalize(seqRow) {
  var newSeqRow = seqRow.toString();
  if ("" == newSeqRow) {
    return "";
  }
  if ("_" != newSeqRow.substr(0, 1)) {
    return "_" + newSeqRow;
  }
  return newSeqRow;
}
function nmAjaxChangeCss(cssChanges, seqRow)
{
    let baseSeq = seqRow.substr(1), underscoreSeq = "_" + baseSeq, ruleSelector, ruleName;
    for (ruleSelector in cssChanges) {
        for (ruleSeq in cssChanges[ruleSelector]) {
            if ("ajax_navigate" == seqRow) {
                baseSeq = ruleSeq;
                underscoreSeq = "_" + baseSeq;
            }
            for (ruleName in cssChanges[ruleSelector][ruleSeq]) {
                if ("sc_badge" == ruleName) {
                    if ("" != ruleSelector) {
                        $("#id_sc_field_" + ruleSelector + underscoreSeq).removeClass("sc-badge-pill").removeClass("sc-b-blue").removeClass("sc-b-brown").removeClass("sc-b-cyan").removeClass("sc-b-gray").removeClass("sc-b-green").removeClass("sc-b-orange").removeClass("sc-b-pink").removeClass("sc-b-purple").removeClass("sc-b-red").removeClass("sc-b-yellow");
                    }
                    if ("" != cssChanges[ruleSelector][ruleSeq][ruleName]) {
                        $("#id_sc_field_" + ruleSelector + underscoreSeq).addClass("sc-badge-pill").addClass("sc-b-" + cssChanges[ruleSelector][ruleSeq][ruleName]);
                    }
                } else if ("__sc_row" == ruleSelector) {
                    $("#SC_ancor" + baseSeq + " .scGridFieldOddFont").css(ruleName, cssChanges[ruleSelector][ruleSeq][ruleName]);
                    $("#SC_ancor" + baseSeq + " .scGridFieldEvenFont").css(ruleName, cssChanges[ruleSelector][ruleSeq][ruleName]);
                } else {
                    $("#SC_ancor" + baseSeq + " .css_" + ruleSelector + "_grid_line").css(ruleName, cssChanges[ruleSelector][ruleSeq][ruleName]);
                }
            }
        }
    }
}
  function nmAjaxRedir(oTemp)
  {
    if (oTemp && oTemp != null) {
        oResp = oTemp;
    }
    if (!oResp["redirInfo"]) {
      return;
    }
    sMetodo = oResp["redirInfo"]["metodo"];
    sAction = oResp["redirInfo"]["action"];
    if ("location" == sMetodo) {
      if ("parent.parent" == oResp["redirInfo"]["target"]) {
        parent.parent.location = sAction;
      }
      else if ("parent" == oResp["redirInfo"]["target"]) {
        parent.location = sAction;
      }
      else if ("_blank" == oResp["redirInfo"]["target"]) {
        window.open(sAction, "_blank");
      }
      else {
        document.location = sAction;
      }
    }
    else if ("html" == sMetodo) {
        document.write(nmAjaxSpecCharParser(oResp["redirInfo"]["action"]));
    }
    else {
      if (oResp["redirInfo"]["target"] == "modal") {
          tb_show('', sAction + '?script_case_init=' +  oResp["redirInfo"]["script_case_init"] + '&nmgp_parms=' + oResp["redirInfo"]["nmgp_parms"] + '&nmgp_outra_jan=true&nmgp_url_saida=modal&NMSC_modal=ok&TB_iframe=true&modal=true&height=' +  oResp["redirInfo"]["h_modal"] + '&width=' + oResp["redirInfo"]["w_modal"], '');
          return;
      }
      sFormRedir = (oResp["redirInfo"]["nmgp_outra_jan"]) ? "form_ajax_redir_1" : "form_ajax_redir_2";
      document.forms[sFormRedir].action           = sAction;
      document.forms[sFormRedir].target           = oResp["redirInfo"]["target"];
      document.forms[sFormRedir].nmgp_parms.value = oResp["redirInfo"]["nmgp_parms"];
      if ("form_ajax_redir_1" == sFormRedir) {
        document.forms[sFormRedir].nmgp_outra_jan.value = oResp["redirInfo"]["nmgp_outra_jan"];
      }
      else {
        document.forms[sFormRedir].nmgp_url_saida.value   = oResp["redirInfo"]["nmgp_url_saida"];
        document.forms[sFormRedir].script_case_init.value = oResp["redirInfo"]["script_case_init"];
      }
      document.forms[sFormRedir].submit();
    }
  }
var json_err_crtl    = 1;
var Id_Btn_selected  = new Array();
var Css_Btn_selected = new Array();
Id_Btn_selected[0] = "selcmp_top";
Id_Btn_selected[1] = "dynamic_search_top";
function ajax_navigate(opc, parm)
{
    var scrollNavigateReload = false, extraParams = "", iEvt, iStart = 0, rebindClickOnFixedCols = false;
       $('.group_col_backdrop').remove();
    for (ibtn = 0; ibtn < 2; ibtn++) {
        Css_Btn_selected[ibtn] = $("#" + Id_Btn_selected[ibtn]).attr('class');
    }
    nmAjaxProcOn();
    if ("rec" == opc || "ordem" == opc) {
      rebindClickOnFixedCols = true;
    }
    if (scrollNavigateReload) {
      extraParams += "&scrollNavigateReload=Y";
    }
    if (typeof parm !== "string") {
      parm = parm.toString();
    }
    parm = parm.replace(/[+]/g, "__NM_PLUS__");
    while (parm.lastIndexOf("&amp;") != -1)
    {
       parm = parm.replace("&amp;" , "__NM_AMP__");
    }
    parm = parm.replace(/[&]/g, "__NM_AMP__");
    parm = parm.replace(/[%]/g, "__NM_PRC__");
    parm_save = parm;
    return new Promise(function(resolve, reject) {$.ajax({
      type: "POST",
      url: "index.php",
      data: "nmgp_opcao=ajax_navigate&script_case_init=" + document.F4.script_case_init.value + "&opc=" + opc  + "&parm=" + parm + extraParams
     })
     .fail(function(jqxhr, textStatus, error) {
        var err = textStatus + ", " + error;
        if (json_err_crtl == 1) {
            json_err_crtl++;
            ajax_navigate(opc, parm);
        }
        else {
            nmAjaxProcOff();
            json_err_crtl = 1;
            alert (err);
        }
     })
     .done(function(jsonNavigate) {
        var i, oResp;
        json_err_crtl = 1;
        Tst_integrid = jsonNavigate.trim();
        if ("{" != Tst_integrid.substr(0, 1)) {
            nmAjaxProcOff();
            alert (jsonNavigate);
            return;
        }
        eval("oResp = " + jsonNavigate);
        if (oResp["ss_time_out"]) {
            nmAjaxProcOff();
            nm_move();
        }
        if (!SC_Proc_Mobile) {
            document.getElementById('nmsc_iframe_liga_A_grid_proyectos').src = 'NM_Blank_Page.htm';
            document.getElementById('nmsc_iframe_liga_E_grid_proyectos').src = 'NM_Blank_Page.htm';
            document.getElementById('nmsc_iframe_liga_D_grid_proyectos').src = 'NM_Blank_Page.htm';
            document.getElementById('nmsc_iframe_liga_B_grid_proyectos').src = 'NM_Blank_Page.htm';
            document.getElementById('nmsc_iframe_liga_A_grid_proyectos').style.height = '0px';
            document.getElementById('nmsc_iframe_liga_E_grid_proyectos').style.height = '0px';
            document.getElementById('nmsc_iframe_liga_D_grid_proyectos').style.height = '0px';
            document.getElementById('nmsc_iframe_liga_B_grid_proyectos').style.height = '0px';
            document.getElementById('nmsc_iframe_liga_A_grid_proyectos').style.width  = '0px';
            document.getElementById('nmsc_iframe_liga_E_grid_proyectos').style.width  = '0px';
            document.getElementById('nmsc_iframe_liga_D_grid_proyectos').style.width  = '0px';
            document.getElementById('nmsc_iframe_liga_B_grid_proyectos').style.width  = '0px';
        }
        if (oResp["setValue"]) {
          for (i = 0; i < oResp["setValue"].length; i++) {
            $("#" + oResp["setValue"][i]["field"]).html(oResp["setValue"][i]["value"]);
          }
        }
        if (oResp["setTitle"]) {
          for (i = 0; i < oResp["setTitle"].length; i++) {
            $("#" + oResp["setTitle"][i]["field"]).attr('title', oResp["setTitle"][i]["value"]);
          }
        }
        if (oResp["setArr"]) {
          for (i = 0; i < oResp["setArr"].length; i++) {
               eval (oResp["setArr"][i]["var"] + ' = new Array()');
          }
        }
        if (oResp["setVar"]) {
          for (i = 0; i < oResp["setVar"].length; i++) {
               eval (oResp["setVar"][i]["var"] + ' = \"' + oResp["setVar"][i]["value"] + '\"');
          }
        }
        if (oResp["fillArr"]) {
          for (i = 0; i < oResp["fillArr"].length; i++) {
               eval (oResp["fillArr"][i]["var"] + ' = {' + oResp["fillArr"][i]["value"] + '}');
          }
        }
        if (oResp["setDisplay"]) {
          for (i = 0; i < oResp["setDisplay"].length; i++) {
            if (document.getElementById(oResp["setDisplay"][i]["field"])) {
              document.getElementById(oResp["setDisplay"][i]["field"]).style.display = oResp["setDisplay"][i]["value"];
            }
          }
        }
        if (oResp["setVisibility"]) {
          for (i = 0; i < oResp["setVisibility"].length; i++) {
            if (document.getElementById(oResp["setVisibility"][i]["field"])) {
              document.getElementById(oResp["setVisibility"][i]["field"]).style.visibility = oResp["setVisibility"][i]["value"];
            }
          }
        }
        if (oResp["setDisabled"]) {
          for (i = 0; i < oResp["setDisabled"].length; i++) {
            if (document.getElementById(oResp["setDisabled"][i]["field"])) {
              document.getElementById(oResp["setDisabled"][i]["field"]).disabled = oResp["setDisabled"][i]["value"];
            }
          }
        }
        if (oResp["setClass"]) {
          for (i = 0; i < oResp["setClass"].length; i++) {
            if (document.getElementById(oResp["setClass"][i]["field"])) {
              document.getElementById(oResp["setClass"][i]["field"]).className = oResp["setClass"][i]["value"];
            }
          }
        }
        if (oResp["setSrc"]) {
          for (i = 0; i < oResp["setSrc"].length; i++) {
            if (document.getElementById(oResp["setSrc"][i]["field"])) {
              document.getElementById(oResp["setSrc"][i]["field"]).src = oResp["setSrc"][i]["value"];
            }
          }
        }
        if (oResp["remove_Obj"]) {
          for (i = 0; i < oResp["remove_Obj"].length; i++) {
            if (document.getElementById(oResp["remove_Obj"][i])) {
              document.getElementById(oResp["remove_Obj"][i]).remove();
            }
          }
        }
        if (oResp["redirInfo"]) {
           nmAjaxRedir(oResp);
        }
        if (oResp["changeCss"]) {
           nmAjaxChangeCss(oResp["changeCss"], 'ajax_navigate');
        }
        if (oResp["AlertJS"]) {
          for (i = 0; i < oResp["AlertJS"].length; i++) {
              jsAlertParams = oResp["AlertJSParam"][i] ? oResp["AlertJSParam"][i] : {};
              scJs_alert (oResp["AlertJS"][i], jsAlertParams);
          }
        }
        if (oResp["exec_JS"]) {
          for (i = 0; i < oResp["exec_JS"].length; i++) {
               eval (oResp["exec_JS"][i]["function"] + '("' + oResp["exec_JS"][i]["parm"] + '");');
          }
        }
        if (oResp["htmOutput"]) {
           nmAjaxShowDebug(oResp);
        }
        if (!SC_Link_View)
        {
            if (Qsearch_ok)
            {
                scQuickSearchKeyUp('top', null);
            }
            SC_init_jquery(false);
            tb_init('a.thickbox, area.thickbox, input.thickbox');
        }
        for (ibtn = 0; ibtn < 2; ibtn++) {
             $("#" + Id_Btn_selected[ibtn]).attr('class', Css_Btn_selected[ibtn]);
        }
        nmAjaxProcOff();
        resolve();
    })});
}
function ajax_navigate_res(opc, parm)
{
       $('.group_col_backdrop').remove();
    nmAjaxProcOn();
    parm_save = parm;
    $.ajax({
      type: "POST",
      url: "index.php",
      data: "nmgp_opcao=ajax_navigate&script_case_init=" + document.FRES.script_case_init.value + "&opc=" + opc  + "&parm=" + parm
     })
     .done(function(jsonNavigate) {
        var i, oResp;
        Tst_integrid = jsonNavigate.trim();
        if ("{" != Tst_integrid.substr(0, 1)) {
            nmAjaxProcOff();
            alert (jsonNavigate);
            return;
        }
        eval("oResp = " + jsonNavigate);
        if (oResp["ss_time_out"]) {
            nmAjaxProcOff();
            nm_move();
        }
        if (oResp["setValue"]) {
          for (i = 0; i < oResp["setValue"].length; i++) {
            $("#" + oResp["setValue"][i]["field"]).html(oResp["setValue"][i]["value"]);
          }
        }
        if (oResp["setTitle"]) {
          for (i = 0; i < oResp["setTitle"].length; i++) {
            $("#" + oResp["setTitle"][i]["field"]).attr('title', oResp["setTitle"][i]["value"]);
          }
        }
        if (oResp["setArr"]) {
          for (i = 0; i < oResp["setArr"].length; i++) {
               eval (oResp["setArr"][i]["var"] + ' = new Array()');
          }
        }
        if (oResp["setVar"]) {
          for (i = 0; i < oResp["setVar"].length; i++) {
               eval (oResp["setVar"][i]["var"] + ' = \"' + oResp["setVar"][i]["value"] + '\"');
          }
        }
        if (oResp["fillArr"]) {
          for (i = 0; i < oResp["fillArr"].length; i++) {
               eval (oResp["fillArr"][i]["var"] + ' = {' + oResp["fillArr"][i]["value"] + '}');
          }
        }
        if (oResp["setDisplay"]) {
          for (i = 0; i < oResp["setDisplay"].length; i++) {
            if (document.getElementById(oResp["setDisplay"][i]["field"])) {
              document.getElementById(oResp["setDisplay"][i]["field"]).style.display = oResp["setDisplay"][i]["value"];
            }
          }
        }
        if (oResp["setVisibility"]) {
          for (i = 0; i < oResp["setVisibility"].length; i++) {
            if (document.getElementById(oResp["setVisibility"][i]["field"])) {
              document.getElementById(oResp["setVisibility"][i]["field"]).style.visibility = oResp["setVisibility"][i]["value"];
            }
          }
        }
        if (oResp["setDisabled"]) {
          for (i = 0; i < oResp["setDisabled"].length; i++) {
            if (document.getElementById(oResp["setDisabled"][i]["field"])) {
              document.getElementById(oResp["setDisabled"][i]["field"]).disabled = oResp["setDisabled"][i]["value"];
            }
          }
        }
        if (oResp["setClass"]) {
          for (i = 0; i < oResp["setClass"].length; i++) {
            if (document.getElementById(oResp["setClass"][i]["field"])) {
              document.getElementById(oResp["setClass"][i]["field"]).className = oResp["setClass"][i]["value"];
            }
          }
        }
        if (oResp["setSrc"]) {
          for (i = 0; i < oResp["setSrc"].length; i++) {
            if (document.getElementById(oResp["setSrc"][i]["field"])) {
              document.getElementById(oResp["setSrc"][i]["field"]).src = oResp["setSrc"][i]["value"];
            }
          }
        }
        if (oResp["redirInfo"]) {
           nmAjaxRedir(oResp);
        }
        if (oResp["AlertJS"]) {
          for (i = 0; i < oResp["AlertJS"].length; i++) {
              jsAlertParams = oResp["AlertJSParam"][i] ? oResp["AlertJSParam"][i] : {};
              scJs_alert (oResp["AlertJS"][i], jsAlertParams);
          }
        }
        if (oResp["exec_JS"]) {
          for (i = 0; i < oResp["exec_JS"].length; i++) {
               eval (oResp["exec_JS"][i]["function"] + '("' + oResp["exec_JS"][i]["parm"] + '");');
          }
        }
        if (oResp["htmOutput"]) {
           nmAjaxShowDebug(oResp);
        }
        nmAjaxProcOff();
        if (oResp["exec_script"]) {
          for (i = 0; i < oResp["exec_script"].length; i++) {
              eval (oResp["exec_script"][i]);
          }
        }
    });
}
function ajax_save_ancor(f_submit, ancor)
{
    nmAjaxProcOn();
    $.ajax({
      type: "POST",
      url: "index.php",
      data: "nmgp_opcao=ajax_save_ancor&script_case_init=" + document.F3.script_case_init.value + "&ancor_save=" + ancor
     })
     .done(function(jsonSaveAncor) {
        nmAjaxProcOff();
        eval ("document." + f_submit + ".submit()");
    });
}
var strPath         = '';
var strTitle        = '';
var showAjaxProcess = true;
function ajax_export(tp_export, parms, strCallback, showAjax)
{
    strPath  = '';
    strTitle  = '';
    showAjaxProcess = showAjax;
    if(showAjaxProcess)
    {
        nmAjaxProcOn();
    }
    $.ajax({
      type: "POST",
      url: "index.php",
      data: "nmgp_opcao=ajax_export&export_opc=" + tp_export + parms + "&script_case_init=" + document.F3.script_case_init.value,
      complete: strCallback,
     })
     .done(function(jsonFile) {
        var oResp;
        Tst_integrid = jsonFile.trim();
        if ("{" != Tst_integrid.substr(0, 1)) {
            nmAjaxProcOff();
            alert (jsonFile);
            return;
        }
        eval("oResp = " + jsonFile);
        if (oResp["ss_time_out"]) {
            nmAjaxProcOff();
            nm_move();
        }
        if (oResp["htmOutput"]) {
           nmAjaxShowDebug(oResp);
        }
        if (oResp["file_export"]) {
            strPath = oResp['file_export'];
            strTitle = oResp['title_export'];
        }
        if(showAjaxProcess)
        {
            nmAjaxProcOff();
        }
    });
}

